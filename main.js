!function(){"use strict";class e{constructor(e,t){let{data:s,handleImageClick:r,handleDeleteCard:i,confirmPopup:o,api:n}=e;this._name=s.name,this._link=s.link,this._id=s._id,this._isLiked=s.isLiked,this._cardSelector=t,this._handleImageClick=r,this._handleDeleteCard=i,this._confirmPopup=o,this._api=n}_setEventListeners(){this._cardImage.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})})),this._likeButton.addEventListener("click",this._handleLikeIcon),this._deleteButton.addEventListener("click",(()=>{this._handleDeleteCard(this,this._id)}))}removeCard(){this._cardElement.remove(),this._cardElement=null}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0)}_setLike(){this._isLiked&&this._likeButton.classList.add("card__like-button_active")}_handleLikeIcon=()=>{this._isLiked?this._api.unlikeCard(this._id).then((()=>{this._likeButton.classList.remove("card__like-button_active"),this._isLiked=!this._isLiked})).catch((e=>{console.error(e)})):this._api.likeCard(this._id).then((()=>{this._likeButton.classList.add("card__like-button_active"),this._isLiked=!this._isLiked})).catch((e=>{console.error(e)}))};getView(){return this._cardElement=this._getTemplate(),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._deleteButton=this._cardElement.querySelector(".card__delete-button"),this._cardImage=this._cardElement.querySelector(".card__image"),this._cardTitle=this._cardElement.querySelector(".card__title"),this._cardTitle.textContent=this._name,this._cardImage.src=this._link,this._cardImage.alt=this._name,this._setEventListeners(),this._setLike(),this._cardElement}}class t{constructor(e){console.log(e),this._popupElement=document.querySelector(e)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keyup",this._handleEscClose),document.addEventListener("mousedown",this._closeModalOnRemoteClick)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keyup",this._handleEscClose),document.removeEventListener("mousedown",this._closeModalOnRemoteClick)}_handleEscClose=e=>{"Escape"===e.key&&this.close()};_closeModalOnRemoteClick=e=>{(e.target.classList.contains("modal_opened")||e.target.classList.contains("modal__close"))&&this.close()};setEventListeners(){this._popupCloseButton=this._popupElement.querySelector(".modal__close-button"),this._popupCloseButton.addEventListener("click",(()=>this.close()))}}class s extends t{constructor(e,t){super(e),console.log(this._popupElement),this._popupForm=this._popupElement.querySelector(".modal__form"),console.log(this._popupForm),this._handleFormSubmit=t,this._inputList=this._popupForm.querySelectorAll(".modal__input"),this._submitButton=this._popupElement.querySelector(".modal__button"),this._submitButtonText=this._submitButton.textContent}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Saving...";this._submitButton.textContent=e?t:this._submitButtonText}close(){super.close(),this._popupForm.reset()}_getInputValues(){const e={};for(const t of this._inputList)e[t.name]=t.value;return e}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this.renderLoading(!0);const t=this._getInputValues();this._handleFormSubmit(t).then((()=>{this.close()})).finally((()=>{this.renderLoading(!1)}))}))}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}}const r=document.querySelector(".profile__add-button"),i=document.querySelector("#profile-edit-button"),o=document.querySelector('input[name="name"]'),n=document.querySelector('input[name="about"]'),a=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s}_request(e,t){return fetch(e,t).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getInitialCards(){return this._request(`${this._baseUrl}/cards`,{headers:this._headers})}getUserInfo(){return this._request(`${this._baseUrl}/users/me`,{method:"GET",headers:this._headers}).finally((()=>{console.log("Done with user info")}))}updateUserInfo(e){return this._request(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})})}addNewCards(e){return this._request(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify(e)}).then((e=>e)).finally((()=>{console.log("Done adding New Card Information from Server")}))}likeCard(e){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:this._headers,body:JSON.stringify({isLiked:!0})})}unlikeCard(e){return this._request(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:this._headers})}deleteCard(e){return this._request(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>e)).finally((()=>{console.log("Done deleting card")}))}updateAvatar(e){return this._request(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e.avatar})})}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"7ed3bb2f-7b5a-422d-a884-e2fa31c7bd62","Content-Type":"application/json"}}),l=new class{constructor(e){let{nameSelector:t,jobSelector:s,avatarSelector:r}=e;this._name=document.querySelector(t),this._job=document.querySelector(s),this._profileImage=document.querySelector(r)}getUserInfo(){return{name:this._name.textContent,job:this._job.textContent,image:this._profileImage.src}}setUserInfo(e){let{name:t,about:s,avatar:r}=e;this._name.textContent=t,console.log(this._name),this._job.textContent=s,console.log(r),this._profileImage.src=r}}({nameSelector:".profile__title",jobSelector:".profile__description",avatarSelector:".profile__image"}),d=new s("#modal-edit-avatar",(e=>a.updateAvatar(e).then((e=>{l.setUserInfo(e)})).catch((e=>{console.error(e)}))));d.setEventListeners(),document.querySelector("#profile-image-pencil").addEventListener("click",(()=>{v["edit-avatar-form"].resetValidation(),d.open()}));const c=new class extends t{constructor(e){let{popupSelector:t,handleConfirm:s}=e;super(t),this._handleConfirm=s,this._confirmButton=this._popupElement.querySelector(".modal__form-button")}renderLoading(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Deleting...";this._confirmButton.textContent=e?t:"Yes"}open(e,t){super.open(),this._card=e,this._cardId=t}setEventListeners(){super.setEventListeners(),this._confirmButton.addEventListener("click",(()=>{this.renderLoading(!0),this._handleConfirm(this._card,this._cardId).then((()=>{this.close()})).finally((()=>{this.renderLoading(!1)}))}))}}({popupSelector:"#delete-card-modal",handleConfirm:(e,t)=>a.deleteCard(t).then((()=>{e.removeCard()})).catch((e=>{console.error(e)}))});c.setEventListeners();const h=new class extends t{constructor(e){let{popupSelector:t}=e;super(t),this._previewImage=this._popupElement.querySelector(".modal__image-preview"),this._previewImageTitle=this._popupElement.querySelector(".modal__image-title")}open(e){this._previewImage.src=e.link,this._previewImage.alt=e.name,this._previewImageTitle.textContent=e.name,super.open()}}({popupSelector:"#preview-image-modal"});let _;const u=t=>{const s=new e({data:t,handleImageClick:e=>{h.open(e)},handleDeleteCard:(e,t)=>{c.open(e,t)},confirmPopup:c,api:a},"#card-template");_.addItem(s.getView())};_=new class{constructor(e,t){let{renderer:s}=e;this._renderer=s,this._container=document.querySelector(t)}renderItems(e){console.log("oooooooooooooo"),console.log(e),e.forEach((e=>this._renderer(e)))}addItem(e){this._container.prepend(e)}}({renderer:u},".cards__list");const m=new s("#add-card-modal",(e=>a.addNewCards(e).then((e=>{u(e)})).catch((e=>{console.error(e)}))));Promise.all([a.getUserInfo(),a.getInitialCards()]).then((e=>{let[t,s]=e;l.setUserInfo(t),_.renderItems(s)})).catch((e=>{console.error(e)}));const p=new s("#profile-edit-modal",(e=>a.updateUserInfo(e).then((e=>{l.setUserInfo(e)})).catch((e=>{console.error(e)}))));p.setEventListeners(),m.setEventListeners(),h.setEventListeners();const v={};var E;E={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},Array.from(document.querySelectorAll(E.formSelector)).forEach((e=>{const t=new class{constructor(e,t){this._formElement=t,console.log(this._formElement),this._inputSelector=e.inputSelector,this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector)),this._submitButton=this._formElement.querySelector(e.submitButtonSelector),this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}_showInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._formElement.querySelector(`#${e.id}-error`);e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_hasInvalidInput(){return this._inputList.every((e=>e.validity.valid))}toggleButtonState(){this._hasInvalidInput()?(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1):(this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0)}resetValidation(){this.toggleButtonState(),this._inputList.forEach((e=>{this._hideInputError(e)}))}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}(E,e),s=e.getAttribute("name");v[s]=t,t.enableValidation()})),i.addEventListener("click",(()=>{v["edit-profile-form"].resetValidation(),(()=>{const e=l.getUserInfo();o.value=e.name,n.value=e.job})(),p.open()})),r.addEventListener("click",(()=>{v["add-card-form"].resetValidation(),m.open()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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RCxHQUFZcEIsRUFDM0JBLEVBQVVtQixrQkFBa0IsSUEyQmhDMUcsRUFBa0JsRSxpQkFBaUIsU0FBUyxLQUMxQzhHLEVBQWUscUJBQXFCQyxrQkFSWGdFLE1BQ3pCLE1BQU1uQyxFQUFXMUMsRUFBU2QsY0FDMUJqQixFQUFVUCxNQUFRZ0YsRUFBU3pKLEtBQzNCaUYsRUFBaUJSLE1BQVFnRixFQUFTcEMsR0FBRyxFQU1yQ3VFLEdBQ0FqQyxFQUFpQmhILE1BQU0sSUFJekJtQyxFQUFpQmpFLGlCQUFpQixTQUFTLEtBQ3pDOEcsRUFBZSxpQkFBaUJDLGtCQUNoQzJCLEVBQWE1RyxNQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1VzZXJJbmZvLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9TZWN0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHsgZGF0YSwgaGFuZGxlSW1hZ2VDbGljaywgaGFuZGxlRGVsZXRlQ2FyZCwgY29uZmlybVBvcHVwLCBhcGkgfSxcbiAgICBjYXJkVGVtcGxhdGVTZWxlY3RvclxuICApIHtcbiAgICB0aGlzLl9uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2xpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5faWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9pc0xpa2VkID0gZGF0YS5pc0xpa2VkO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRUZW1wbGF0ZVNlbGVjdG9yO1xuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQgPSBoYW5kbGVEZWxldGVDYXJkO1xuICAgIHRoaXMuX2NvbmZpcm1Qb3B1cCA9IGNvbmZpcm1Qb3B1cDtcbiAgICB0aGlzLl9hcGkgPSBhcGk7XG4gIH1cblxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHsgbmFtZTogdGhpcy5fbmFtZSwgbGluazogdGhpcy5fbGluayB9KTtcbiAgICB9KTtcblxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUxpa2VJY29uKTtcblxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCh0aGlzLCB0aGlzLl9pZCk7XG4gICAgfSk7XG4gIH1cbiAgLy8gZGVsZXRlIHRoZSBjYXJkIGFuZCByZW1vdmUgdGhlIGxpbmsgdG8gdGhlIERPTSBlbGVtZW50XG4gIHJlbW92ZUNhcmQoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xuICB9XG5cbiAgX2dldFRlbXBsYXRlKCkge1xuICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICAgIHJldHVybiBjYXJkRWxlbWVudDtcbiAgfVxuICBfc2V0TGlrZSgpIHtcbiAgICBpZiAodGhpcy5faXNMaWtlZCkge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH1cbiAgfVxuXG4gIF9oYW5kbGVMaWtlSWNvbiA9ICgpID0+IHtcbiAgICBpZiAoIXRoaXMuX2lzTGlrZWQpIHtcbiAgICAgIHRoaXMuX2FwaVxuICAgICAgICAubGlrZUNhcmQodGhpcy5faWQpXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgICAgICAgdGhpcy5faXNMaWtlZCA9ICF0aGlzLl9pc0xpa2VkO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9hcGlcbiAgICAgICAgLnVubGlrZUNhcmQodGhpcy5faWQpXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XG4gICAgICAgICAgdGhpcy5faXNMaWtlZCA9ICF0aGlzLl9pc0xpa2VkO1xuICAgICAgICB9KVxuICAgICAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gdGhpcy5fZ2V0VGVtcGxhdGUoKTtcbiAgICB0aGlzLl9saWtlQnV0dG9uID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiXG4gICAgKTtcbiAgICB0aGlzLl9jYXJkSW1hZ2UgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcbiAgICB0aGlzLl9jYXJkSW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fc2V0TGlrZSgpO1xuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yKSB7XG4gICAgY29uc29sZS5sb2cocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcbiAgfVxuICAvL29wZW5zIHBvcHVwXG4gIG9wZW4oKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIHRoaXMuX2Nsb3NlTW9kYWxPblJlbW90ZUNsaWNrKTtcbiAgfVxuICAvL2Nsb3NlIHBvcHVwXG4gIGNsb3NlKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCB0aGlzLl9jbG9zZU1vZGFsT25SZW1vdGVDbGljayk7XG4gIH1cblxuICBfaGFuZGxlRXNjQ2xvc2UgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgX2Nsb3NlTW9kYWxPblJlbW90ZUNsaWNrID0gKGV2dCkgPT4ge1xuICAgIGlmIChcbiAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfb3BlbmVkXCIpIHx8XG4gICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsX19jbG9zZVwiKVxuICAgICkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cENsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5tb2RhbF9fY2xvc2UtYnV0dG9uXCJcbiAgICApO1xuICAgIHRoaXMuX3BvcHVwQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHRoaXMuY2xvc2UoKSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cHdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICAvLyBUaGUgcG9wdXAgc2VsZWN0b3IsIGFuZCBhIGNhbGxiYWNrIGZ1bmN0aW9uIHdoZW4gUG9wdXBXaXRoRm9ybSBjYWxscyBhbmQgdGhlIGZvcm3igJlzIHN1Ym1pdCBldmVudCBmaXJlc1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgY29uc29sZS5sb2codGhpcy5fcG9wdXBFbGVtZW50KTtcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICBjb25zb2xlLmxvZyh0aGlzLl9wb3B1cEZvcm0pO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2lucHV0TGlzdCA9IHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblRleHQgPSB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQ7XG4gIH1cbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmdUZXh0ID0gXCJTYXZpbmcuLi5cIikge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IGxvYWRpbmdUZXh0O1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24udGV4dENvbnRlbnQgPSB0aGlzLl9zdWJtaXRCdXR0b25UZXh0O1xuICAgIH1cbiAgfVxuXG4gIC8vIHJlc2V0IHRoZSBmb3JtIG9uY2UgdGhlIHBvcHVwIGlzIGNsb3NlZFxuICBjbG9zZSgpIHtcbiAgICBzdXBlci5jbG9zZSgpO1xuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xuICB9XG4gIC8vY29sbGVjdHMgZGF0YSBmcm9tIGFsbCB0aGUgaW5wdXQgZmllbGRzIGFuZCByZXR1cm5zIHRoYXQgZGF0YSBhcyBhbiBvYmplY3QuXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xuICAgIGZvciAoY29uc3QgaW5wdXQgb2YgdGhpcy5faW5wdXRMaXN0KSB7XG4gICAgICBpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xuICAgIH1cblxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuICAvLyBhZGQgc3VibWl0IGV2ZW50IGxpc3RlbmVyIHRvIHRoZSBmb3JtIGFuZCBjbGljayBoYW5kbGVyIHRvIHRoZSBjbG9zZSBpY29uXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gICAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHRoaXMuX2dldElucHV0VmFsdWVzKCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KGlucHV0VmFsdWVzKVxuICAgICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KVxuICAgICAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBzZXQgdXNlciBpbmZvcm1hdGlvbiB0byBmb3JtXG4gIHNldElucHV0VmFsdWVzKGRhdGEpIHtcbiAgICB0aGlzLl9pbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0LnZhbHVlID0gZGF0YVtpbnB1dC5uYW1lXTtcbiAgICB9KTtcbiAgfVxufVxuIiwiY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICB7XG4gICAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcbiAgfSxcbl07XG5cbmV4cG9ydCBjb25zdCBjYXJkRGF0YSA9IHtcbiAgbmFtZTogXCJZb3NlbWl0ZSBWYWxsZXlcIixcbiAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxufTtcblxuY29uc3Qgc2V0dGluZ3MgPSB7XG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcbiAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXG4gIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxuICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxufTtcblxuLy8gQnV0dG9uXG5jb25zdCBhZGROZXdDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1idXR0b25cIik7XG4vL2lucHV0c1xuZXhwb3J0IGNvbnN0IG5hbWVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJuYW1lXCJdJyk7XG5leHBvcnQgY29uc3QgZGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2lucHV0W25hbWU9XCJhYm91dFwiXScpO1xuXG5jb25zdCBjYXJkc0xpc3RTZWxlY3RvciA9IFwiLmNhcmRzX19saXN0XCI7XG5cbmV4cG9ydCB7XG4gIGluaXRpYWxDYXJkcyxcbiAgc2V0dGluZ3MsXG4gIGFkZE5ld0NhcmRCdXR0b24sXG4gIHByb2ZpbGVFZGl0QnV0dG9uLFxuICBjYXJkc0xpc3RTZWxlY3Rvcixcbn07XG4iLCJpbXBvcnQgQ2FyZCBmcm9tIFwiLi4vY29tcG9uZW50cy9DYXJkLmpzXCI7XG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XG5pbXBvcnQgUG9wdXAgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXAuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IFVzZXJJbmZvIGZyb20gXCIuLi9jb21wb25lbnRzL1VzZXJJbmZvLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuaW1wb3J0IFwiLi4vcGFnZXMvaW5kZXguY3NzXCI7XG5pbXBvcnQgUG9wdXBXaXRoQ29uZmlybWF0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aENvbmZpcm1hdGlvbi5qc1wiO1xuXG5pbXBvcnQge1xuICBpbml0aWFsQ2FyZHMsXG4gIGNhcmRzTGlzdFNlbGVjdG9yLFxuICBzZXR0aW5ncyxcbiAgbmFtZUlucHV0LFxuICBkZXNjcmlwdGlvbklucHV0LFxuICBhZGROZXdDYXJkQnV0dG9uLFxuICBwcm9maWxlRWRpdEJ1dHRvbixcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xuXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCI3ZWQzYmIyZi03YjVhLTQyMmQtYTg4NC1lMmZhMzFjN2JkNjJcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fdGl0bGVcIixcbiAgam9iU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIsXG4gIGF2YXRhclNlbGVjdG9yOiBcIi5wcm9maWxlX19pbWFnZVwiLFxufSk7XG5cbmNvbnN0IGVkaXRBdmF0YXJQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI21vZGFsLWVkaXQtYXZhdGFyXCIsIChkYXRhKSA9PiB7XG4gIHJldHVybiBhcGlcbiAgICAudXBkYXRlQXZhdGFyKGRhdGEpXG4gICAgLnRoZW4oKHJlcykgPT4ge1xuICAgICAgdXNlckluZm8uc2V0VXNlckluZm8ocmVzKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIH0pO1xufSk7XG5lZGl0QXZhdGFyUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuZG9jdW1lbnRcbiAgLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1pbWFnZS1wZW5jaWxcIilcbiAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgZm9ybVZhbGlkYXRvcnNbXCJlZGl0LWF2YXRhci1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xuICAgIGVkaXRBdmF0YXJQb3B1cC5vcGVuKCk7XG4gIH0pO1xuXG5jb25zdCBjb25maXJtQWN0aW9uID0gKGNhcmQsIGNhcmRJZCkgPT4ge1xuICByZXR1cm4gYXBpXG4gICAgLmRlbGV0ZUNhcmQoY2FyZElkKVxuICAgIC50aGVuKCgpID0+IHtcbiAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfSk7XG59O1xuXG5jb25zdCBkZWxldGVDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKHtcbiAgcG9wdXBTZWxlY3RvcjogXCIjZGVsZXRlLWNhcmQtbW9kYWxcIixcbiAgaGFuZGxlQ29uZmlybTogY29uZmlybUFjdGlvbixcbn0pO1xuXG5kZWxldGVDYXJkUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgaWFtZ2VQcmV2aWV3UG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uoe1xuICBwb3B1cFNlbGVjdG9yOiBcIiNwcmV2aWV3LWltYWdlLW1vZGFsXCIsXG59KTtcblxubGV0IHNlY3Rpb247XG5cbmNvbnN0IHJlbmRlckNhcmQgPSAoZGF0YSkgPT4ge1xuICBjb25zdCBjYXJkRWxlbWVudCA9IG5ldyBDYXJkKFxuICAgIHtcbiAgICAgIGRhdGE6IGRhdGEsXG4gICAgICBoYW5kbGVJbWFnZUNsaWNrOiAoaW1hZ2VEYXRhKSA9PiB7XG4gICAgICAgIGlhbWdlUHJldmlld1BvcHVwLm9wZW4oaW1hZ2VEYXRhKTtcbiAgICAgIH0sXG4gICAgICBoYW5kbGVEZWxldGVDYXJkOiAoY2FyZCwgY2FyZElkKSA9PiB7XG4gICAgICAgIGRlbGV0ZUNhcmRQb3B1cC5vcGVuKGNhcmQsIGNhcmRJZCk7XG4gICAgICB9LFxuICAgICAgY29uZmlybVBvcHVwOiBkZWxldGVDYXJkUG9wdXAsXG4gICAgICBhcGk6IGFwaSxcbiAgICB9LFxuICAgIFwiI2NhcmQtdGVtcGxhdGVcIlxuICApO1xuXG4gIHNlY3Rpb24uYWRkSXRlbShjYXJkRWxlbWVudC5nZXRWaWV3KCkpO1xufTtcbnNlY3Rpb24gPSBuZXcgU2VjdGlvbihcbiAge1xuICAgIHJlbmRlcmVyOiByZW5kZXJDYXJkLFxuICB9LFxuICBjYXJkc0xpc3RTZWxlY3RvclxuKTtcblxuY29uc3QgYWRkQ2FyZFBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjYWRkLWNhcmQtbW9kYWxcIiwgKGRhdGEpID0+IHtcbiAgcmV0dXJuIGFwaVxuICAgIC5hZGROZXdDYXJkcyhkYXRhKVxuICAgIC50aGVuKChyZXMpID0+IHtcbiAgICAgIHJlbmRlckNhcmQocmVzKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIH0pO1xufSk7XG5cblByb21pc2UuYWxsKFthcGkuZ2V0VXNlckluZm8oKSwgYXBpLmdldEluaXRpYWxDYXJkcygpXSlcbiAgLnRoZW4oKFt1c2VyRGF0YSwgY2FyZHNdKSA9PiB7XG4gICAgdXNlckluZm8uc2V0VXNlckluZm8odXNlckRhdGEpO1xuICAgIHNlY3Rpb24ucmVuZGVySXRlbXMoY2FyZHMpO1xuICB9KVxuICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gIH0pO1xuXG5jb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsIChkYXRhKSA9PiB7XG4gIHJldHVybiBhcGlcbiAgICAudXBkYXRlVXNlckluZm8oZGF0YSlcbiAgICAudGhlbigocmVzKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRVc2VySW5mbyhyZXMpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfSk7XG59KTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgRXZlbnQgTGlzdG5lciAgICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuLy8gZW5lYmxlIGV2ZW50IGxpc3RlbmVycyBpbiBlYWNoIGZvcm1cbmVkaXRQcm9maWxlUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbmFkZENhcmRQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xuaWFtZ2VQcmV2aWV3UG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLyogLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICBGb3JtIFZhbGlkYXRpb24gICAgICovXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuY29uc3QgZm9ybVZhbGlkYXRvcnMgPSB7fTtcbi8vIGVuYWJsZSB2YWxpZGF0aW9uXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKHNldHRpbmdzKSA9PiB7XG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHNldHRpbmdzLmZvcm1TZWxlY3RvcikpO1xuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xuICAgIGNvbnN0IHZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHNldHRpbmdzLCBmb3JtRWxlbWVudCk7XG4gICAgLy8gaGVyZSB5b3UgZ2V0IHRoZSBuYW1lIG9mIHRoZSBmb3JtXG4gICAgY29uc3QgZm9ybU5hbWUgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJuYW1lXCIpO1xuXG4gICAgLy8gaGVyZSB5b3Ugc3RvcmUgYSB2YWxpZGF0b3IgYnkgdGhlIGBuYW1lYCBvZiB0aGUgZm9ybVxuICAgIGZvcm1WYWxpZGF0b3JzW2Zvcm1OYW1lXSA9IHZhbGlkYXRvcjtcbiAgICB2YWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuICB9KTtcbn07XG5cbmVuYWJsZVZhbGlkYXRpb24oc2V0dGluZ3MpO1xuXG4vKiAtLS0tLS0tLS0tLS0tLS0tLS0gKi9cbi8qICAgICAgRnVuY3Rpb25zICAgICAqL1xuLyogLS0tLS0tLS0tLS0tLS0tLS0tICovXG4vLyBmdW5jdGlvbiBoYW5kbGVFZGl0UHJvZmlsZVN1Ym1pdChuYW1lLCBkZXNjcmlwdGlvbikge1xuLy8gICBjb25zb2xlLmxvZyhuYW1lLCBkZXNjcmlwdGlvbik7XG4vLyAgIHVzZXJJbmZvLnNldFVzZXJJbmZvKG5hbWUsIGRlc2NyaXB0aW9uKTtcbi8vICAgZWRpdFByb2ZpbGVQb3B1cC5jbG9zZSgpO1xuLy8gfVxuXG4vLyBmdW5jdGlvbiBoYW5kbGVBZGRDYXJkU3VibWl0KG5hbWUsIGxpbmspIHtcbi8vICAgcmVuZGVyQ2FyZCh7IG5hbWU6IG5hbWUsIGxpbms6IGxpbmsgfSk7XG4vLyAgIGFkZENhcmRQb3B1cC5jbG9zZSgpO1xuLy8gfVxuXG5jb25zdCBzZXRFZGl0UG9wdXBWYWx1ZXMgPSAoKSA9PiB7XG4gIGNvbnN0IHVzZXJEYXRhID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgbmFtZUlucHV0LnZhbHVlID0gdXNlckRhdGEubmFtZTtcbiAgZGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IHVzZXJEYXRhLmpvYjtcbn07XG5cbi8vIGhhbmRsZSB0aGUgcHJvZmlsZSBlZGl0IHBvcHVwXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9yc1tcImVkaXQtcHJvZmlsZS1mb3JtXCJdLnJlc2V0VmFsaWRhdGlvbigpO1xuICBzZXRFZGl0UG9wdXBWYWx1ZXMoKTtcbiAgZWRpdFByb2ZpbGVQb3B1cC5vcGVuKCk7XG59KTtcblxuLy9oYW5kbGUgdGhlIHBob3RvIGFkZCBwb3B1cFxuYWRkTmV3Q2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBmb3JtVmFsaWRhdG9yc1tcImFkZC1jYXJkLWZvcm1cIl0ucmVzZXRWYWxpZGF0aW9uKCk7XG4gIGFkZENhcmRQb3B1cC5vcGVuKCk7XG59KTtcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEFwaSB7XG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XG4gIH1cblxuICAvLyBfY2hlY1Jlc3BvbnNlKHJlcykge1xuICAvLyAgIGlmIChyZXMub2spIHtcbiAgLy8gICAgIHJldHVybiByZXMuanNvbigpO1xuICAvLyAgIH1cbiAgLy8gICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gIC8vIH1cblxuICAvLyBfcmVxdWVzdChuYW1lLCBsaW5rKSB7XG4gIC8vICAgcmV0dXJuIGZldGNoKG5hbWUsIGxpbmspLnRoZW4odGhpcy5fY2hlY1Jlc3BvbnNlKTtcbiAgLy8gfVxuXG4gIF9yZXF1ZXN0KHVybCwgb3B0aW9ucykge1xuICAgIHJldHVybiBmZXRjaCh1cmwsIG9wdGlvbnMpLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGdldEluaXRpYWxDYXJkcygpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkc2AsIHtcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXG4gICAgfSk7XG4gICAgLy8gLnRoZW4oKHJlc3VsdCkgPT4ge1xuICAgIC8vICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIC8vICAgICAuZmluYWxseSgoKSA9PiB7XG4gIC8vICAgICAgIGNvbnNvbGUubG9nKFwiRG9uIHdpdGggaW5pdGlhbCBjYXJkc1wiKTtcbiAgLy8gICAgIH0pO1xuICAvLyB9XG5cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XG4gICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pLmZpbmFsbHkoKCkgPT4ge1xuICAgICAgY29uc29sZS5sb2coXCJEb25lIHdpdGggdXNlciBpbmZvXCIpO1xuICAgIH0pO1xuICB9XG5cbiAgdXBkYXRlVXNlckluZm8oZGF0YSkge1xuICAgIHJldHVybiB0aGlzLl9yZXF1ZXN0KGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBkYXRhLm5hbWUsXG4gICAgICAgIGFib3V0OiBkYXRhLmFib3V0LFxuICAgICAgfSksXG4gICAgfSk7XG4gIH1cblxuICBhZGROZXdDYXJkcyhkYXRhKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KGRhdGEpLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xuICAgICAgfSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coXCJEb25lIGFkZGluZyBOZXcgQ2FyZCBJbmZvcm1hdGlvbiBmcm9tIFNlcnZlclwiKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgbGlrZUNhcmQoY2FyZElkKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xuICAgICAgbWV0aG9kOiBcIlBVVFwiLFxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgaXNMaWtlZDogdHJ1ZSxcbiAgICAgIH0pLFxuICAgIH0pO1xuICB9XG5cbiAgdW5saWtlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pO1xuICB9XG5cbiAgZGVsZXRlQ2FyZChjYXJkSWQpIHtcbiAgICByZXR1cm4gdGhpcy5fcmVxdWVzdChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH1gLCB7XG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgIH0pXG4gICAgICAudGhlbigocmVzcG9uc2UpID0+IHtcbiAgICAgICAgcmV0dXJuIHJlc3BvbnNlO1xuICAgICAgfSlcbiAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2coXCJEb25lIGRlbGV0aW5nIGNhcmRcIik7XG4gICAgICB9KTtcbiAgfVxuXG4gIHVwZGF0ZUF2YXRhcihkYXRhKSB7XG4gICAgcmV0dXJuIHRoaXMuX3JlcXVlc3QoYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBhdmF0YXI6IGRhdGEuYXZhdGFyLFxuICAgICAgfSksXG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGpvYlNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9qb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGpvYlNlbGVjdG9yKTtcbiAgICB0aGlzLl9wcm9maWxlSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcbiAgfVxuXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxuICAgICAgam9iOiB0aGlzLl9qb2IudGV4dENvbnRlbnQsXG4gICAgICBpbWFnZTogdGhpcy5fcHJvZmlsZUltYWdlLnNyYyxcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8oeyBuYW1lLCBhYm91dCwgYXZhdGFyIH0pIHtcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICBjb25zb2xlLmxvZyh0aGlzLl9uYW1lKTtcbiAgICB0aGlzLl9qb2IudGV4dENvbnRlbnQgPSBhYm91dDtcbiAgICBjb25zb2xlLmxvZyhhdmF0YXIpO1xuICAgIHRoaXMuX3Byb2ZpbGVJbWFnZS5zcmMgPSBhdmF0YXI7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciwgaGFuZGxlQ29uZmlybSB9KSB7XG4gICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5faGFuZGxlQ29uZmlybSA9IGhhbmRsZUNvbmZpcm07XG4gICAgdGhpcy5fY29uZmlybUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIubW9kYWxfX2Zvcm0tYnV0dG9uXCJcbiAgICApO1xuICB9XG5cbiAgcmVuZGVyTG9hZGluZyhpc0xvYWRpbmcsIGxvYWRpbmcgPSBcIkRlbGV0aW5nLi4uXCIpIHtcbiAgICBpZiAoaXNMb2FkaW5nKSB7XG4gICAgICB0aGlzLl9jb25maXJtQnV0dG9uLnRleHRDb250ZW50ID0gbG9hZGluZztcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fY29uZmlybUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiWWVzXCI7XG4gICAgfVxuICB9XG5cbiAgb3BlbihjYXJkLCBjYXJkSWQpIHtcbiAgICBzdXBlci5vcGVuKCk7XG4gICAgdGhpcy5fY2FyZCA9IGNhcmQ7XG4gICAgdGhpcy5fY2FyZElkID0gY2FyZElkO1xuICB9XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgIHRoaXMuX2NvbmZpcm1CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIC8vIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICAgICAgdGhpcy5faGFuZGxlQ29uZmlybSh0aGlzLl9jYXJkLCB0aGlzLl9jYXJkSWQpXG4gICAgICAgIC50aGVuKCgpID0+IHtcbiAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgICAgICB0aGlzLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX3ByZXZpZXdJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIubW9kYWxfX2ltYWdlLXByZXZpZXdcIlxuICAgICk7XG4gICAgdGhpcy5fcHJldmlld0ltYWdlVGl0bGUgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiLm1vZGFsX19pbWFnZS10aXRsZVwiXG4gICAgKTtcbiAgfVxuICAvL0FkZCBhbiBpbWFnZSB0byB0aGUgcG9wdXAgYW5kIHRoZSBjb3JyZXNwb25kaW5nIGltYWdlIHNyYywgYXR0cmlidXRlIGFsb25nIHdpdGggYSBjYXB0aW9uIGZvciB0aGUgaW1hZ2UuXG4gIG9wZW4oZGF0YSkge1xuICAgIHRoaXMuX3ByZXZpZXdJbWFnZS5zcmMgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5fcHJldmlld0ltYWdlLmFsdCA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2VUaXRsZS50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XG4gICAgLy8gdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICB9XG5cbiAgLy8gcmVuZGVySXRlbXMoaXRlbXMpIHtcbiAgLy8gICBjb25zb2xlLmxvZyhcIj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XCIpO1xuICAvLyAgIGNvbnNvbGUubG9nKGl0ZW1zLmpzb24oKSk7XG4gIC8vICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAvLyAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gIC8vICAgfSk7XG4gIC8vIH1cblxuICByZW5kZXJJdGVtcyhpdGVtcykge1xuICAgIGNvbnNvbGUubG9nKFwib29vb29vb29vb29vb29cIik7XG4gICAgY29uc29sZS5sb2coaXRlbXMpO1xuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHRoaXMuX3JlbmRlcmVyKGl0ZW0pKTtcbiAgfVxuXG4gIGFkZEl0ZW0oZWxlbWVudCkge1xuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICB9XG59XG4iLCJjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSBmb3JtRWxlbWVudDtcbiAgICBjb25zb2xlLmxvZyh0aGlzLl9mb3JtRWxlbWVudCk7XG4gICAgdGhpcy5faW5wdXRTZWxlY3RvciA9IHNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcbiAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcilcbiAgICApO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBzZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvclxuICAgICk7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gc2V0dGluZ3MuaW5wdXRFcnJvckNsYXNzO1xuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xuICB9XG5cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudC52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgIGNvbnN0IGVycm9yTWVzc2FnZUVsID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgIGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYFxuICAgICk7XG5cbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gXCJcIjtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG5cbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9XG4gIH1cblxuICBfaGFzSW52YWxpZElucHV0KCkge1xuICAgIHJldHVybiB0aGlzLl9pbnB1dExpc3QuZXZlcnkoKGlucHV0KSA9PiBpbnB1dC52YWxpZGl0eS52YWxpZCk7XG4gIH1cblxuICB0b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBjb25zdCBpc0Zvcm1WYWxpZCA9IHRoaXMuX2hhc0ludmFsaWRJbnB1dCgpO1xuICAgIGlmIChpc0Zvcm1WYWxpZCkge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSBmYWxzZTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICAgIH1cbiAgfVxuXG4gIHJlc2V0VmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICB9KTtcbiAgfVxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaW5wdXRFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJpbnB1dFwiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIGVuYWJsZVZhbGlkYXRpb24oKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG59XG5leHBvcnQgZGVmYXVsdCBGb3JtVmFsaWRhdG9yO1xuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkVGVtcGxhdGVTZWxlY3RvciIsImRhdGEiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2FyZCIsImNvbmZpcm1Qb3B1cCIsImFwaSIsInRoaXMiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaWQiLCJfaXNMaWtlZCIsImlzTGlrZWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2FyZCIsIl9jb25maXJtUG9wdXAiLCJfYXBpIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2NhcmRJbWFnZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJfbGlrZUJ1dHRvbiIsIl9oYW5kbGVMaWtlSWNvbiIsIl9kZWxldGVCdXR0b24iLCJyZW1vdmVDYXJkIiwiX2NhcmRFbGVtZW50IiwicmVtb3ZlIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsIl9zZXRMaWtlIiwiY2xhc3NMaXN0IiwiYWRkIiwidW5saWtlQ2FyZCIsInRoZW4iLCJjYXRjaCIsImVycm9yIiwiY29uc29sZSIsImxpa2VDYXJkIiwiZ2V0VmlldyIsIl9jYXJkVGl0bGUiLCJ0ZXh0Q29udGVudCIsInNyYyIsImFsdCIsIlBvcHVwIiwicG9wdXBTZWxlY3RvciIsImxvZyIsIl9wb3B1cEVsZW1lbnQiLCJvcGVuIiwiX2hhbmRsZUVzY0Nsb3NlIiwiX2Nsb3NlTW9kYWxPblJlbW90ZUNsaWNrIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiZXZ0Iiwia2V5IiwidGFyZ2V0IiwiY29udGFpbnMiLCJzZXRFdmVudExpc3RlbmVycyIsIl9wb3B1cENsb3NlQnV0dG9uIiwiUG9wdXB3aXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9pbnB1dExpc3QiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsIl9zdWJtaXRCdXR0b25UZXh0IiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsImxvYWRpbmdUZXh0IiwiYXJndW1lbnRzIiwibGVuZ3RoIiwidW5kZWZpbmVkIiwicmVzZXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJwcmV2ZW50RGVmYXVsdCIsImZpbmFsbHkiLCJzZXRJbnB1dFZhbHVlcyIsImZvckVhY2giLCJhZGROZXdDYXJkQnV0dG9uIiwicHJvZmlsZUVkaXRCdXR0b24iLCJuYW1lSW5wdXQiLCJkZXNjcmlwdGlvbklucHV0IiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX3JlcXVlc3QiLCJ1cmwiLCJvcHRpb25zIiwiZmV0Y2giLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiZ2V0SW5pdGlhbENhcmRzIiwiZ2V0VXNlckluZm8iLCJtZXRob2QiLCJ1cGRhdGVVc2VySW5mbyIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJhZGROZXdDYXJkcyIsInJlc3BvbnNlIiwiY2FyZElkIiwiZGVsZXRlQ2FyZCIsInVwZGF0ZUF2YXRhciIsImF2YXRhciIsImF1dGhvcml6YXRpb24iLCJ1c2VySW5mbyIsIm5hbWVTZWxlY3RvciIsImpvYlNlbGVjdG9yIiwiYXZhdGFyU2VsZWN0b3IiLCJfam9iIiwiX3Byb2ZpbGVJbWFnZSIsImpvYiIsImltYWdlIiwic2V0VXNlckluZm8iLCJfcmVmMiIsImVkaXRBdmF0YXJQb3B1cCIsIlBvcHVwV2l0aEZvcm0iLCJmb3JtVmFsaWRhdG9ycyIsInJlc2V0VmFsaWRhdGlvbiIsImRlbGV0ZUNhcmRQb3B1cCIsImhhbmRsZUNvbmZpcm0iLCJfaGFuZGxlQ29uZmlybSIsIl9jb25maXJtQnV0dG9uIiwibG9hZGluZyIsImNhcmQiLCJfY2FyZCIsIl9jYXJkSWQiLCJjb25maXJtQWN0aW9uIiwiaWFtZ2VQcmV2aWV3UG9wdXAiLCJfcHJldmlld0ltYWdlIiwiX3ByZXZpZXdJbWFnZVRpdGxlIiwic2VjdGlvbiIsInJlbmRlckNhcmQiLCJjYXJkRWxlbWVudCIsImltYWdlRGF0YSIsImFkZEl0ZW0iLCJjb250YWluZXJTZWxlY3RvciIsInJlbmRlcmVyIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbXMiLCJpdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJhZGRDYXJkUG9wdXAiLCJhbGwiLCJ1c2VyRGF0YSIsImNhcmRzIiwiZWRpdFByb2ZpbGVQb3B1cCIsInNldHRpbmdzIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJBcnJheSIsImZyb20iLCJmb3JtRWxlbWVudCIsInZhbGlkYXRvciIsIl9mb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2VFbCIsImlkIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oYXNJbnZhbGlkSW5wdXQiLCJldmVyeSIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiZGlzYWJsZWQiLCJlbmFibGVWYWxpZGF0aW9uIiwiZm9ybU5hbWUiLCJnZXRBdHRyaWJ1dGUiLCJzZXRFZGl0UG9wdXBWYWx1ZXMiXSwic291cmNlUm9vdCI6IiJ9